<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GENERATOR PROMPT AI by Sing Sareh</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Add a modern digital-like font if possible, or use a generic sans-serif -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a1a2e; /* Dark background */
            color: #e0e0e0; /* Light text */
            margin: 0;
            padding: 20px; /* Base padding */
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            box-sizing: border-box;
        }
        /* Responsive padding for body */
        @media (min-width: 640px) { /* sm breakpoint */
            body {
                padding: 24px; /* p-6 */
            }
        }
        @media (min-width: 768px) { /* md breakpoint */
            body {
                padding: 32px; /* p-8 */
            }
        }

        .container {
            background-color: #2a2a4a; /* Slightly lighter dark background for container */
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
            width: 100%;
            max-width: 1200px;
            padding: 30px;
            box-sizing: border-box;
        }
        /* Updated Glowing Title Styling */
        .app-title-container {
            text-align: center;
            margin-bottom: 20px;
        }
        .app-title-main {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.2rem; /* Base size for mobile */
            font-weight: 700;
            color: #ffffff;
            text-shadow: 0 0 10px #00bfff, 0 0 20px #00bfff, 0 0 30px #00bfff, 0 0 40px #00bfff;
            animation: glow 1.5s ease-in-out infinite alternate;
            display: block;
            line-height: 1.2;
        }
        /* Responsive font sizes for main title */
        @media (min-width: 640px) { /* sm breakpoint */
            .app-title-main {
                font-size: 2.8rem;
            }
        }
        @media (min-width: 768px) { /* md breakpoint */
            .app-title-main {
                font-size: 3.2rem; /* Slightly larger for desktop */
            }
        }

        .app-title-sub {
            font-family: 'Inter', sans-serif;
            font-size: 0.9rem; /* Base size for mobile */
            font-weight: 600;
            color: #ff9900; /* Contrasting color (orange/gold) */
            display: block;
            margin-top: 5px;
        }
        /* Responsive font sizes for sub-title */
        @media (min-width: 640px) { /* sm breakpoint */
            .app-title-sub {
                font-size: 1.1rem;
            }
        }
        @media (min-width: 768px) { /* md breakpoint */
            .app-title-sub {
                font-size: 1.2rem;
            }
        }

        @keyframes glow {
            from {
                text-shadow: 0 0 5px #00bfff, 0 0 10px #00bfff;
            }
            to {
                text-shadow: 0 0 15px #00bfff, 0 0 25px #00bfff, 0 0 35px #00bfff;
            }
        }
        .tab-button {
            padding: 12px 25px;
            border-radius: 10px 10px 0 0;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            background-color: #3a3a5a;
            color: #a0a0c0;
            border: none;
        }
        .tab-button.active {
            background-color: #4a4a7a;
            color: #ffffff;
            box-shadow: inset 0 3px 10px rgba(0, 0, 0, 0.3);
        }
        .tab-button:hover:not(.active) {
            background-color: #4a4a7a;
            color: #ffffff;
        }
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #c0c0e0;
        }
        .input-group input,
        .input-group textarea,
        .input-group select {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #5a5a8a;
            background-color: #3a3a5a;
            color: #e0e0e0;
            box-sizing: border-box;
            transition: border-color 0.3s ease;
        }
        .input-group input:focus,
        .input-group textarea:focus,
        .input-group select:focus {
            outline: none;
            border-color: #00bfff;
            box-shadow: 0 0 0 2px rgba(0, 191, 255, 0.5);
        }
        .button-primary {
            background-color: #00bfff;
            color: white;
            padding: 12px 25px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            border: none;
            box-shadow: 0 5px 15px rgba(0, 191, 255, 0.4);
        }
        .button-primary:hover {
            background-color: #009acd;
            transform: translateY(-2px);
        }
        .button-secondary {
            background-color: #5a5a8a;
            color: #e0e0e0;
            padding: 12px 25px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            border: none;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
        }
        .button-secondary:hover {
            background-color: #6a6a9a;
            transform: translateY(-2px);
        }
        .button-disabled {
            opacity: 0.6;
            cursor: not-allowed;
            box-shadow: none;
        }
        .result-area {
            background-color: #1a1a2e;
            border-radius: 10px;
            padding: 20px;
            min-height: 150px;
            border: 1px solid #5a5a8a;
            white-space: pre-wrap; /* Preserve whitespace and line breaks */
            word-wrap: break-word; /* Break long words */
            overflow-x: auto; /* Allow horizontal scrolling if content is too wide */
        }
        .additional-results-area { /* New style for the separate area */
            background-color: #1a1a2e;
            border-radius: 10px;
            padding: 20px;
            min-height: 50px; /* Smaller min-height for additional results */
            border: 1px solid #5a5a8a;
            white-space: pre-wrap;
            word-wrap: break-word;
            overflow-x: auto;
            margin-top: 20px; /* Add some space above */
        }
        .loading-spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #00bfff;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        /* Message Box Styling */
        .message-box {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #4CAF50; /* Green for success */
            color: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }
        .message-box.error {
            background-color: #f44336; /* Red for error */
        }
        .message-box.show {
            opacity: 1;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 p-5">
    <div class="container">
        <!-- Updated App Title Structure -->
        <div class="app-title-container">
            <span class="app-title-main">GENERATOR PROMPT AI</span>
            <span class="app-title-sub">by Sing Sareh</span>
        </div>
        <p class="text-center text-base sm:text-lg mb-8 text-gray-300">Isi bidang-bidang di bawah untuk membuat prompt yang sangat detail</p>

        <!-- User Status Message (Removed login buttons) -->
        <div class="flex flex-col sm:flex-row justify-center items-center gap-2 mb-4">
            <span class="text-center text-sm text-gray-500" id="user-status-message">
                Fitur AI aktif.
            </span>
            <!-- Removed Login/Logout Buttons -->
        </div>

        <!-- Navigation Tabs -->
        <div class="flex flex-wrap justify-center gap-2 mb-8"> <!-- Added flex-wrap and gap-2 -->
            <button id="tab-gambar" class="tab-button active">üñºÔ∏è Gambar</button>
            <button id="tab-video-tunggal" class="tab-button">üé¨ Video Tunggal</button>
            <button id="tab-sutradara" class="tab-button">üé• Sutradara</button>
            <button id="tab-teks" class="tab-button">‚úçÔ∏è Teks</button>
        </div>

        <!-- Tab Content -->
        <div id="tab-content-gambar" class="tab-content">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <div class="input-group">
                    <label for="gaya-gambar">Gaya Gambar</label>
                    <select id="gaya-gambar">
                        <option value="">Pilih</option>
                        <option value="Fotorealistik">Fotorealistik</option>
                        <option value="Animasi 3D">Animasi 3D</option>
                        <option value="Seni Digital">Seni Digital</option>
                        <option value="Kartun">Kartun</option>
                        <option value="Sketsa">Sketsa</option>
                        <option value="Cat Air">Cat Air</option>
                        <option value="Gaya Komik">Gaya Komik</option>
                        <option value="Pixel Art">Pixel Art</option>
                        <option value="Gaya Impresionistik">Gaya Impresionistik</option>
                        <option value="Gaya Abstrak">Gaya Abstrak</option>
                        <option value="Minimalis">Minimalis</option>
                        <option value="Gaya Cyberpunk">Gaya Cyberpunk</option>
                        <option value="Gaya Steampunk">Gaya Steampunk</option>
                        <option value="Vaporwave">Vaporwave</option>
                        <option value="Gaya Renaisans">Gaya Renaisans</option>
                        <option value="Gaya Barok">Gaya Barok</option>
                        <option value="Gaya Art Deco">Gaya Art Deco</option>
                        <option value="Gaya Futuristik">Gaya Futuristik</option>
                        <option value="Gaya Fantasi Gelap">Gaya Fantasi Gelap</option>
                        <option value="Gaya Realisme Magis">Gaya Realisme Magis</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="kategori-gambar">Kategori Gambar</label>
                    <select id="kategori-gambar">
                        <option value="">Pilih</option>
                        <option value="Manusia/Potret">Manusia/Potret</option>
                        <option value="Alam/Lanskap">Alam/Lanskap</option>
                        <option value="Hewan/Makhluk">Hewan/Makhluk</option>
                        <option value="Teknologi/Fiksi Ilmiah">Teknologi/Fiksi Ilmiah</option>
                        <option value="Fantasi">Fantasi</option>
                        <option value="Arsitektur/Bangunan">Arsitektur/Bangunan</option>
                        <option value="Makanan/Minuman">Makanan/Minuman</option>
                        <option value="Kendaraan">Kendaraan</option>
                        <option value="Abstrak">Abstrak</option>
                        <option value="Pendidikan">Pendidikan</option>
                        <option value="Sejarah">Sejarah</option>
                        <option value="Budaya">Budaya</option>
                        <option value="Olahraga">Olahraga</option>
                        <option value="Musik">Musik</option>
                        <option value="Horor">Horor</option>
                        <option value="Misteri">Misteri</option>
                        <option value="Ruang Angkasa">Ruang Angkasa</option>
                        <option value="Bawah Laut">Bawah Laut</option>
                        <option value="Makro">Makro</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="sudut-kamera">Sudut Kamera</label>
                    <select id="sudut-kamera">
                        <option value="">Pilih</option>
                        <option value="Low Angle">Low Angle (Kamera di bawah subjek, membuat subjek terlihat besar/berkuasa)</option>
                        <option value="High Angle">High Angle (Kamera di atas subjek, membuat subjek terlihat kecil/lemah)</option>
                        <option value="Close-up">Close-up (Fokus dekat pada objek/wajah, mengisi sebagian besar bingkai)</option>
                        <option value="Wide Shot">Wide Shot (Menunjukkan seluruh subjek dan lingkungan luasnya)</option>
                        <option value="Medium Shot">Medium Shot (Menunjukkan subjek dari pinggang ke atas)</option>
                        <option value="Extreme Close-up">Extreme Close-up (Fokus sangat dekat pada detail spesifik, seperti mata atau jari)</option>
                        <option value="Over-the-Shoulder Shot">Over-the-Shoulder Shot (Kamera di belakang bahu satu karakter, menghadap karakter lain)</option>
                        <option value="Point of View">Point of View (Menunjukkan apa yang dilihat oleh karakter)</option>
                        <option value="Bird's Eye View">Bird's Eye View (Sudut pandang dari atas, melihat ke bawah pada subjek, seringkali untuk menunjukkan lokasi)</option>
                        <option value="Worm's Eye View">Worm's Eye View (Sudut pandang dari bawah, melihat ke atas pada subjek)</option>
                        <option value="Dutch Angle">Dutch Angle (Kamera dimiringkan ke satu sisi, menciptakan efek disorientasi)</option>
                        <option value="Tracking Shot">Tracking Shot (Kamera bergerak mengikuti subjek, biasanya di atas rel atau dolly)</option>
                        <option value="Crane Shot">Crane Shot (Kamera bergerak vertikal atau melintasi ruang menggunakan crane)</option>
                        <option value="Handheld Shot">Handheld Shot (Kamera dipegang tangan, menciptakan kesan realistis dan tidak stabil)</option>
                        <option value="Static Shot">Static Shot (Kamera diam, tidak bergerak)</option>
                        <option value="Mengikuti Objek">Mengikuti Objek (Kamera terus bergerak mengikuti pergerakan objek utama)</option>
                        <option value="Zoom Cepat">Zoom Cepat (Pembesaran/pengecilan cepat untuk efek dramatis)</option>
                        <option value="Gerakan Lambat">Gerakan Lambat (Perekaman dengan frame rate tinggi untuk efek dramatis)</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="waktu-pencahayaan">Waktu/Pencahayaan</label>
                    <select id="waktu-pencahayaan">
                        <option value="">Pilih</option>
                        <option value="Golden Hour">Golden Hour</option>
                        <option value="Blue Hour">Blue Hour</option>
                        <option value="Siang Hari Cerah">Siang Hari Cerah</option>
                        <option value="Malam Hari">Malam Hari</option>
                        <option value="Cahaya Studio">Cahaya Studio</option>
                        <option value="Cahaya Lilin">Cahaya Lilin</option>
                        <option value="Senja">Senja</option>
                        <option value="Fajar">Fajar</option>
                        <option value="Mendung">Mendung</option>
                        <option value="Cahaya Neon">Cahaya Neon</option>
                        <option value="Cahaya Alami">Cahaya Alami</option>
                        <option value="Cahaya Buatan">Cahaya Buatan</option>
                        <option value="Siluet">Siluet</option>
                        <option value="Kontras Tinggi">Kontras Tinggi</option>
                        <option value="Cahaya Lembut">Cahaya Lembut</option>
                    </select>
                </div>
                <div class="input-group md:col-span-2">
                    <label for="subjek-gambar">Subjek (Siapa/Apa?)</label>
                    <textarea id="subjek-gambar" rows="2" placeholder="Contoh: Seorang wanita muda, Robot futuristik, Pemandangan gunung"></textarea>
                </div>
                <div class="input-group md:col-span-2">
                    <label for="aksi-gambar">Aksi (Apa yang dilakukan/terjadi?)</label>
                    <textarea id="aksi-gambar" rows="2" placeholder="Contoh: Sedang membaca buku, Berjalan di hutan, Ledakan energi"></textarea>
                </div>
                <div class="input-group md:col-span-2">
                    <label for="pengaturan-gambar">Pengaturan (Di mana/Latar belakang?)</label>
                    <textarea id="pengaturan-gambar" rows="2" placeholder="Contoh: Di kafe yang ramai, Hutan belantara, Kota masa depan"></textarea>
                </div>
                <div class="input-group">
                    <label for="suasana-emosi-gambar">Suasana/Emosi Utama</label>
                    <select id="suasana-emosi-gambar">
                        <option value="">Pilih</option>
                        <option value="Tenang">Tenang</option>
                        <option value="Dramatis">Dramatis</option>
                        <option value="Gembira">Gembira</option>
                        <option value="Sedih">Sedih</option>
                        <option value="Misterius">Misterius</option>
                        <option value="Menegangkan">Menegangkan</option>
                        <option value="Inspiratif">Inspiratif</option>
                        <option value="Romantis">Romantis</option>
                        <option value="Suram">Suram</option>
                        <option value="Enerjik">Enerjik</option>
                        <option value="Nostalgia">Nostalgia</option>
                        <option value="Fantasi">Fantasi</option>
                        <option value="Retro">Retro</option>
                        <option value="Modern">Modern</option>
                        <option value="Klasik">Klasik</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="bahan-tekstur-gambar">Bahan/Tekstur (Opsional)</label>
                    <input type="text" id="bahan-tekstur-gambar" placeholder="Contoh: Kayu, Logam, Sutra, Air">
                </div>
                <div class="input-group">
                    <label for="ekspresi-emosi-gambar">Ekspresi/Emosi (Opsional)</label>
                    <input type="text" id="ekspresi-emosi-gambar" placeholder="Contoh: Senyum lebar, Wajah tegang, Mata berbinar">
                </div>
                <div class="input-group">
                    <label for="usia-era-gambar">Usia/Era (Opsional)</label>
                    <input type="text" id="usia-era-gambar" placeholder="Contoh: Abad Pertengahan, 1980-an, Masa depan">
                </div>
                <div class="input-group">
                    <label for="rasio-aspek-gambar">Rasio Aspek (Opsional)</label>
                    <input type="text" id="rasio-aspek-gambar" placeholder="Contoh: 16:9, 4:3, 1:1">
                </div>
                <div class="input-group">
                    <label for="resolusi-gambar">Resolusi (Opsional)</label>
                    <input type="text" id="resolusi-gambar" placeholder="Contoh: 4K, 8K, Ultra HD">
                </div>
                <div class="input-group">
                    <label for="komposisi-gambar">Komposisi (Opsional)</label>
                    <select id="komposisi-gambar">
                        <option value="">Pilih</option>
                        <option value="Aturan Sepertiga">Aturan Sepertiga</option>
                        <option value="Golden Ratio">Golden Ratio</option>
                        <option value="Garis Pemandu">Garis Pemandu</option>
                        <option value="Simetri">Simetri</option>
                        <option value="Asimetri">Asimetri</option>
                        <option value="Segitiga Emas">Segitiga Emas</option>
                        <option value="Ruang Negatif">Ruang Negatif</option>
                        <option value="Bingkai Alami">Bingkai Alami</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="palet-warna-gambar">Palet Warna (Opsional)</label>
                    <select id="palet-warna-gambar">
                        <option value="">Pilih</option>
                        <option value="Monokromatik">Monokromatik</option>
                        <option value="Analog">Analog</option>
                        <option value="Komplementer">Komplementer</option>
                        <option value="Triadik">Triadik</option>
                        <option value="Hangat">Hangat</option>
                        <option value="Dingin">Dingin</option>
                        <option value="Cerah">Cerah</option>
                        <option value="Muted">Muted</option>
                        <option value="Pastel">Pastel</option>
                        <option value="Gelap">Gelap</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="detail-fokus-gambar">Detail & Fokus (Opsional)</label>
                    <select id="detail-fokus-gambar">
                        <option value="">Pilih</option>
                        <option value="Sangat Detail">Sangat Detail</option>
                        <option value="Minimalis">Minimalis</option>
                        <option value="Fokus Tajam">Fokus Tajam</option>
                        <option value="Fokus Lembut">Fokus Lembut</option>
                        <option value="Kedalaman Bidang Dangkal">Kedalaman Bidang Dangkal</option>
                        <option value="Kedalaman Bidang Dalam">Kedalaman Bidang Dalam</option>
                        <option value="Efek Bokeh">Efek Bokeh</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="referensi-artis-gambar">Referensi Artis/Fotografer (Opsional)</label>
                    <input type="text" id="referensi-artis-gambar" placeholder="Contoh: Gaya Van Gogh, Pencahayaan Rembrandt">
                </div>
                <div class="input-group md:col-span-2">
                    <label for="ide-tambahan-gambar">Ide Tambahan (Opsional)</label>
                    <textarea id="ide-tambahan-gambar" rows="2" placeholder="Detail tambahan atau instruksi khusus"></textarea>
                </div>
                <div class="input-group md:col-span-2">
                    <label for="prompt-negatif-gambar">Prompt Negatif (Apa yang tidak diinginkan)</label>
                    <textarea id="prompt-negatif-gambar" rows="2" placeholder="Contoh: Buruk, Distorsi, Teks, Tanda air"></textarea>
                </div>
            </div>
        </div>

        <div id="tab-content-video-tunggal" class="tab-content hidden">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <div class="input-group md:col-span-2">
                    <label for="subjek-video">Subjek Video</label>
                    <textarea id="subjek-video" rows="2" placeholder="Contoh: Sebuah pesawat luar angkasa, Kota yang sibuk"></textarea>
                </div>
                <div class="input-group md:col-span-2">
                    <label for="karakter-utama-video">Karakter Utama (Opsional)</label>
                    <textarea id="karakter-utama-video" rows="2" placeholder="Contoh: Seorang detektif tua, Robot ceria"></textarea>
                </div>
                <div class="input-group md:col-span-2">
                    <label for="karakter-pendukung-video">Karakter Pendukung (Opsional)</label>
                    <textarea id="karakter-pendukung-video" rows="2" placeholder="Contoh: Asisten yang setia, Sekelompok alien"></textarea>
                </div>
                <!-- New: Jumlah Karakter -->
                <div class="input-group">
                    <label for="jumlah-karakter-video">Jumlah Karakter (untuk dialog)</label>
                    <input type="number" id="jumlah-karakter-video" min="0" value="0" placeholder="Contoh: 2">
                </div>
                <div class="input-group">
                    <label for="durasi-video">Durasi Video (detik)</label>
                    <input type="number" id="durasi-video" min="1" value="5" placeholder="Contoh: 5, 10, 30">
                </div>
                <!-- Dynamic Dialog Fields Container -->
                <div id="dialog-fields-container" class="md:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Dynamic dialog fields will be inserted here -->
                </div>

                <div class="input-group md:col-span-2">
                    <label for="aksi-video">Aksi Video</label>
                    <textarea id="aksi-video" rows="2" placeholder="Contoh: Melayang di luar angkasa, Lalu lintas bergerak cepat"></textarea>
                </div>
                <div class="input-group md:col-span-2">
                    <label for="pengaturan-video">Pengaturan Video</label>
                    <textarea id="pengaturan-video" rows="2" placeholder="Contoh: Di luar angkasa dengan latar belakang bumi, Jalanan perkotaan di malam hari"></textarea>
                </div>
                <div class="input-group">
                    <label for="suasana-emosi-video">Suasana/Emosi Video</label>
                    <select id="suasana-emosi-video">
                        <option value="">Pilih</option>
                        <option value="Inspiratif">Inspiratif</option>
                        <option value="Dinamis">Dinamis</option>
                        <option value="Tenang">Tenang</option>
                        <option value="Menegangkan">Menegangkan</option>
                        <option value="Melankolis">Melankolis</option>
                        <option value="Gembira">Gembira</option>
                        <option value="Misterius">Misterius</option>
                        <option value="Epik">Epik</option>
                        <option value="Komedi">Komedi</option>
                        <option value="Horor">Horor</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="pergerakan-kamera">Pergerakan Kamera</label>
                    <select id="pergerakan-kamera">
                        <option value="">Pilih</option>
                        <option value="Pan">Pan (Geser Horizontal)</option>
                        <option value="Tilt">Tilt (Geser Vertikal)</option>
                        <option value="Zoom In">Zoom In</option>
                        <option value="Zoom Out">Zoom Out</option>
                        <option value="Dolly In">Dolly In (Maju ke Subjek)</option>
                        <option value="Dolly Out">Dolly Out (Mundur dari Subjek)</option>
                        <option value="Orbit">Orbit (Mengelilingi Subjek)</option>
                        <option value="Static">Static (Diam)</option>
                        <option value="Mengikuti Objek">Mengikuti Objek (Kamera terus bergerak mengikuti pergerakan objek utama)</option>
                        <option value="Zoom Cepat">Zoom Cepat (Pembesaran/pengecilan cepat untuk efek dramatis)</option>
                        <option value="Gerakan Lambat">Gerakan Lambat (Perekaman dengan frame rate tinggi untuk efek dramatis)</option>
                    </select>
                </div>
                <!-- Changed Gaya Video to dropdown -->
                <div class="input-group">
                    <label for="gaya-video">Gaya Video</label>
                    <select id="gaya-video">
                        <option value="">Pilih</option>
                        <option value="Cinematic">Cinematic</option>
                        <option value="Documentary">Documentary</option>
                        <option value="Vlog Style">Vlog Style</option>
                        <option value="Animation">Animation</option>
                        <option value="Stop Motion">Stop Motion</option>
                        <option value="Time-lapse">Time-lapse</option>
                        <option value="Hyperlapse">Hyperlapse</option>
                        <option value="Slow Motion">Slow Motion</option>
                        <option value="Action Cam">Action Cam</option>
                        <option value="Drone Footage">Drone Footage</option>
                        <option value="Surveillance Footage">Surveillance Footage</option>
                        <option value="Found Footage">Found Footage</option>
                        <option value="Music Video">Music Video</option>
                        <option value="Commercial">Commercial</option>
                        <option value="Explainer Video">Explainer Video</option>
                        <option value="Tutorial">Tutorial</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="bahasa-dialog">Bahasa Dialog (Opsional)</label>
                    <input type="text" id="bahasa-dialog" placeholder="Contoh: Bahasa Inggris, Bahasa Indonesia">
                </div>
                <!-- New: Backsound and Efek Suara -->
                <div class="input-group md:col-span-2">
                    <label for="backsound-video">Backsound (Opsional)</label>
                    <textarea id="backsound-video" rows="2" placeholder="Contoh: Musik latar orkestra epik, Suara alam yang menenangkan"></textarea>
                </div>
                <div class="input-group md:col-span-2">
                    <label for="efek-suara-video">Efek Suara (Opsional)</label>
                    <textarea id="efek-suara-video" rows="2" placeholder="Contoh: Suara ledakan, Deru mesin, Langkah kaki"></textarea>
                </div>
                <div class="input-group">
                    <label for="jenis-shot-video">Jenis Shot (Opsional)</label>
                    <select id="jenis-shot-video">
                        <option value="">Pilih</option>
                        <option value="Establishing Shot">Establishing Shot (Menunjukkan lokasi secara keseluruhan)</option>
                        <option value="Master Shot">Master Shot (Perekaman seluruh adegan dari awal hingga akhir dalam satu bidikan)</option>
                        <option value="Two-Shot">Two-Shot (Menampilkan dua subjek, biasanya dalam percakapan)</option>
                        <option value="POV Shot">POV Shot (Point of View: Bidikan dari sudut pandang karakter)</option>
                        <option value="Insert Shot">Insert Shot (Bidikan detail dari objek penting dalam adegan)</option>
                        <option value="Cutaway Shot">Cutaway Shot (Bidikan yang memotong dari adegan utama ke sesuatu yang lain, lalu kembali lagi)</option>
                        <option value="Close-up">Close-up (Fokus dekat pada objek/wajah)</option>
                        <option value="Medium Shot">Medium Shot (Menampilkan subjek dari pinggang ke atas)</option>
                        <option value="Long Shot">Long Shot (Menampilkan subjek dari kejauhan, menonjolkan lingkungan)</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="transisi-video">Transisi (Opsional)</label>
                    <select id="transisi-video">
                        <option value="">Pilih</option>
                        <option value="Cut">Cut (Perpindahan langsung antar bidikan)</option>
                        <option value="Dissolve">Dissolve (Satu bidikan memudar sementara bidikan berikutnya muncul)</option>
                        <option value="Wipe">Wipe (Satu bidikan mendorong bidikan berikutnya keluar dari bingkai)</option>
                        <option value="Fade In/Out">Fade In/Out (Memudar dari/ke warna solid, biasanya hitam)</option>
                        <option value="Match Cut">Match Cut (Transisi yang mulus dari satu bidikan ke bidikan lain melalui kesamaan visual atau audio)</option>
                        <option value="Jump Cut">Jump Cut (Transisi yang tiba-tiba dan disorientasi, seringkali untuk menunjukkan waktu berlalu cepat)</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="kecepatan-gerak-video">Kecepatan Gerak (Opsional)</label>
                    <select id="kecepatan-gerak-video">
                        <option value="">Pilih</option>
                        <option value="Normal">Normal</option>
                        <option value="Slow Motion">Slow Motion</option>
                        <option value="Fast Motion">Fast Motion</option>
                        <option value="Time-lapse">Time-lapse</option>
                        <option value="Hyperlapse">Hyperlapse</option>
                        <option value="Slow Motion">Slow Motion</option>
                        <option value="Action Cam">Action Cam</option>
                        <option value="Drone Footage">Drone Footage</option>
                        <option value="Surveillance Footage">Surveillance Footage</option>
                        <option value="Found Footage">Found Footage</option>
                        <option value="Music Video">Music Video</option>
                        <option value="Commercial">Commercial</option>
                        <option value="Explainer Video">Explainer Video</option>
                        <option value="Tutorial">Tutorial</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="waktu-dalam-video">Waktu dalam Video (Opsional)</label>
                    <input type="text" id="waktu-dalam-video" placeholder="Contoh: Awal adegan, Puncak konflik">
                </div>

                <div class="input-group md:col-span-2">
                    <label for="ide-tambahan-video">Ide Tambahan (Opsional)</label>
                    <textarea id="ide-tambahan-video" rows="2" placeholder="Detail tambahan atau instruksi khusus untuk video"></textarea>
                </div>
                <div class="input-group md:col-span-2">
                    <label for="prompt-negatif-video">Prompt Negatif (Opsional)</label>
                    <textarea id="prompt-negatif-video" rows="2" placeholder="Apa yang tidak diinginkan dalam video"></textarea>
                </div>
            </div>
        </div>

        <div id="tab-content-sutradara" class="tab-content hidden">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <div class="input-group">
                    <label for="durasi-video-total-sutradara">Durasi Video Total (detik)</label>
                    <input type="number" id="durasi-video-total-sutradara" min="1" value="60" placeholder="Contoh: 60, 120">
                </div>
                <div class="input-group">
                    <label for="durasi-per-segmen-sutradara">Durasi Per Segmen (detik)</label>
                    <input type="number" id="durasi-per-segmen-sutradara" min="1" value="10" placeholder="Contoh: 10, 15">
                </div>
                <div class="input-group md:col-span-2">
                    <label for="gaya-video-sutradara">Gaya Video</label>
                    <select id="gaya-video-sutradara">
                        <option value="">Pilih</option>
                        <option value="Cinematic">Cinematic</option>
                        <option value="Documentary">Documentary</option>
                        <option value="Vlog Style">Vlog Style</option>
                        <option value="Animation">Animation</option>
                        <option value="Stop Motion">Stop Motion</option>
                        <option value="Time-lapse">Time-lapse</option>
                        <option value="Hyperlapse">Hyperlapse</option>
                        <option value="Slow Motion">Slow Motion</option>
                        <option value="Action Cam">Action Cam</option>
                        <option value="Drone Footage">Drone Footage</option>
                        <option value="Surveillance Footage">Surveillance Footage</option>
                        <option value="Found Footage">Found Footage</option>
                        <option value="Music Video">Music Video</option>
                        <option value="Commercial">Commercial</option>
                        <option value="Explainer Video">Explainer Video</option>
                        <option value="Tutorial">Tutorial</option>
                    </select>
                </div>
                <div class="input-group md:col-span-2">
                    <label for="subjek-utama-skenario">Subjek Utama Skenario</label>
                    <textarea id="subjek-utama-skenario" rows="2" placeholder="Contoh: Perjalanan seorang pahlawan, Evolusi teknologi"></textarea>
                </div>
                <div class="input-group md:col-span-2">
                    <label for="alur-cerita-singkat">Alur Cerita Singkat</label>
                    <textarea id="alur-cerita-singkat" rows="4" placeholder="Garis besar cerita atau narasi"></textarea>
                </div>
                <div class="input-group">
                    <label for="genre-sutradara">Genre (Opsional)</label>
                    <select id="genre-sutradara">
                        <option value="">Pilih</option>
                        <option value="Action">Action</option>
                        <option value="Drama">Drama</option>
                        <option value="Comedy">Comedy</option>
                        <option value="Sci-Fi">Sci-Fi</option>
                        <option value="Horor">Horor</option>
                        <option value="Thriller">Thriller</option>
                        <option value="Documentary">Documentary</option>
                        <option value="Musical">Musical</option>
                        <option value="Fantasi">Fantasi</option>
                        <option value="Romantis">Romantis</option>
                        <option value="Misteri">Misteri</option>
                        <option value="Animasi">Animasi</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="struktur-narasi-sutradara">Struktur Narasi (Opsional)</label>
                    <select id="struktur-narasi-sutradara">
                        <option value="">Pilih</option>
                        <option value="Linear">Linear (Alur cerita berurutan dari awal hingga akhir)</option>
                        <option value="Non-linear">Non-linear (Alur cerita tidak berurutan, bisa melompat waktu)</option>
                        <option value="Episodik">Episodik (Terdiri dari serangkaian episode atau segmen yang berdiri sendiri)</option>
                        <option value="Montage">Montage (Urutan bidikan pendek yang cepat untuk menyampaikan informasi atau emosi dalam waktu singkat)</option>
                        <option value="Flashback">Flashback (Kembali ke masa lalu untuk menjelaskan peristiwa saat ini)</option>
                        <option value="Flashforward">Flashforward (Melompat ke masa depan untuk menunjukkan hasil atau peristiwa mendatang)</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="tone-sutradara">Tone/Mood Keseluruhan (Opsional)</label>
                    <select id="tone-sutradara">
                        <option value="">Pilih</option>
                        <option value="Optimistic">Optimistic</option>
                        <option value="Dark">Dark</option>
                        <option value="Whimsical">Whimsical</option>
                        <option value="Serious">Serious</option>
                        <option value="Suspenseful">Suspenseful</option>
                        <option value="Inspiratif">Inspiratif</option>
                        <option value="Melankolis">Melankolis</option>
                        <option value="Humor">Humor</option>
                        <option value="Dramatis">Dramatis</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="target-audiens-sutradara">Target Audiens (Opsional)</label>
                    <input type="text" id="target-audiens-sutradara" placeholder="Contoh: Anak-anak, Remaja, Dewasa, Umum">
                </div>
                <div class="input-group">
                    <label for="sudut-kamera-sutradara">Sudut Kamera (Opsional)</label>
                    <select id="sudut-kamera-sutradara">
                        <option value="">Pilih</option>
                        <option value="Low Angle">Low Angle (Kamera di bawah subjek, membuat subjek terlihat besar/berkuasa)</option>
                        <option value="High Angle">High Angle (Kamera di atas subjek, membuat subjek terlihat kecil/lemah)</option>
                        <option value="Close-up">Close-up (Fokus dekat pada objek/wajah, mengisi sebagian besar bingkai)</option>
                        <option value="Wide Shot">Wide Shot (Menunjukkan seluruh subjek dan lingkungan luasnya)</option>
                        <option value="Medium Shot">Medium Shot (Menunjukkan subjek dari pinggang ke atas)</option>
                        <option value="Extreme Close-up">Extreme Close-up (Fokus sangat dekat pada detail spesifik, seperti mata atau jari)</option>
                        <option value="Over-the-Shoulder Shot">Over-the-Shoulder Shot (Kamera di belakang bahu satu karakter, menghadap karakter lain)</option>
                        <option value="Point of View">Point of View (Menunjukkan apa yang dilihat oleh karakter)</option>
                        <option value="Bird's Eye View">Bird's Eye View (Sudut pandang dari atas, melihat ke bawah pada subjek, seringkali untuk menunjukkan lokasi)</option>
                        <option value="Worm's Eye View">Worm's Eye View (Sudut pandang dari bawah, melihat ke atas pada subjek)</option>
                        <option value="Dutch Angle">Dutch Angle (Kamera dimiringkan ke satu sisi, menciptakan efek disorientasi)</option>
                        <option value="Tracking Shot">Tracking Shot (Kamera bergerak mengikuti subjek, biasanya di atas rel atau dolly)</option>
                        <option value="Crane Shot">Crane Shot (Kamera bergerak vertikal atau melintasi ruang menggunakan crane)</option>
                        <option value="Handheld Shot">Handheld Shot (Kamera dipegang tangan, menciptakan kesan realistis dan tidak stabil)</option>
                        <option value="Static Shot">Static Shot (Kamera diam, tidak bergerak)</option>
                        <option value="Mengikuti Objek">Mengikuti Objek (Kamera terus bergerak mengikuti pergerakan objek utama)</option>
                        <option value="Zoom Cepat">Zoom Cepat (Pembesaran/pengecilan cepat untuk efek dramatis)</option>
                        <option value="Gerakan Lambat">Gerakan Lambat (Perekaman dengan frame rate tinggi untuk efek dramatis)</option>
                    </select>
                </div>
                <div class="input-group md:col-span-2">
                    <label for="pesan-tema-sutradara">Pesan/Tema Utama (Opsional)</label>
                    <textarea id="pesan-tema-sutradara" rows="2" placeholder="Contoh: Pentingnya persahabatan, Bahaya teknologi"></textarea>
                </div>
                <div class="input-group md:col-span-2">
                    <label for="ide-tambahan-skenario">Ide Tambahan (Opsional)</label>
                    <textarea id="ide-tambahan-skenario" rows="2" placeholder="Detail tambahan atau instruksi khusus untuk skenario"></textarea>
                </div>
                <div class="input-group md:col-span-2">
                    <label for="prompt-negatif-skenario">Prompt Negatif (Opsional)</label>
                    <textarea id="prompt-negatif-skenario" rows="2" placeholder="Apa yang tidak diinginkan dalam skenario"></textarea>
                </div>
            </div>
        </div>

        <!-- New: Tab Content for Teks -->
        <div id="tab-content-teks" class="tab-content hidden">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <div class="input-group md:col-span-2">
                    <label for="topik-teks">Topik Teks</label>
                    <textarea id="topik-teks" rows="2" placeholder="Contoh: Sejarah penemuan roda, Manfaat meditasi"></textarea>
                </div>
                <div class="input-group">
                    <label for="gaya-teks">Gaya Teks</label>
                    <select id="gaya-teks">
                        <option value="">Pilih</option>
                        <option value="Formal">Formal</option>
                        <option value="Informal">Informal</option>
                        <option value="Kreatif">Kreatif</option>
                        <option value="Informatif">Informatif</option>
                        <option value="Persuasif">Persuasif</option>
                        <option value="Naratif">Naratif</option>
                        <option value="Deskriptif">Deskriptif</option>
                        <option value="Humor">Humor</option>
                        <option value="Teknis">Teknis</option>
                        <option value="Akademik">Akademik</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="audiens-target-teks">Audiens Target</label>
                    <input type="text" id="audiens-target-teks" placeholder="Contoh: Mahasiswa, Profesional, Anak-anak">
                </div>
                <div class="input-group">
                    <label for="tujuan-teks">Tujuan Teks</label>
                    <input type="text" id="tujuan-teks" placeholder="Contoh: Menjelaskan, Menghibur, Membujuk">
                </div>
                <div class="input-group">
                    <label for="panjang-teks">Panjang Teks</label>
                    <select id="panjang-teks">
                        <option value="">Pilih</option>
                        <option value="Pendek (1-2 paragraf)">Pendek (1-2 paragraf)</option>
                        <option value="Sedang (3-5 paragraf)">Sedang (3-5 paragraf)</option>
                        <option value="Panjang (>5 paragraf)">Panjang (>5 paragraf)</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="struktur-teks">Struktur Teks (Opsional)</label>
                    <select id="struktur-teks">
                        <option value="">Pilih</option>
                        <option value="Esai">Esai</option>
                        <option value="Laporan">Laporan</option>
                        <option value="Cerpen">Cerpen</option>
                        <option value="Puisi">Puisi</option>
                        <option value="Skrip">Skrip</option>
                        <option value="Salinan Pemasaran">Salinan Pemasaran</option>
                        <option value="Posting Blog">Posting Blog</option>
                        <option value="Artikel Berita">Artikel Berita</option>
                        <option value="Ulasan Produk">Ulasan Produk</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="nada-teks">Nada (Tone) (Opsional)</label>
                    <select id="nada-teks">
                        <option value="">Pilih</option>
                        <option value="Formal">Formal</option>
                        <option value="Informal">Informal</option>
                        <option value="Humor">Humor</option>
                        <option value="Serius">Serius</option>
                        <option value="Sarkastik">Sarkastik</option>
                        <option value="Empati">Empati</option>
                        <option value="Mendesak">Mendesak</option>
                        <option value="Tenang">Tenang</option>
                        <option value="Antusias">Antusias</option>
                        <option value="Kritis">Kritis</option>
                    </select>
                </div>
                <div class="input-group md:col-span-2">
                    <label for="kata-kunci-utama-teks">Kata Kunci Utama</label>
                    <input type="text" id="kata-kunci-utama-teks" placeholder="Contoh: AI, etika, masa depan">
                </div>
                <div class="input-group md:col-span-2">
                    <label for="sumber-referensi-teks">Sumber Referensi (Opsional)</label>
                    <textarea id="sumber-referensi-teks" rows="2" placeholder="Contoh: Berdasarkan penelitian terbaru, Mengutip ahli sejarah"></textarea>
                </div>
                <div class="input-group md:col-span-2">
                    <label for="ide-tambahan-teks">Ide Tambahan (Opsional)</label>
                    <textarea id="ide-tambahan-teks" rows="2" placeholder="Detail tambahan atau instruksi khusus untuk teks"></textarea>
                </div>
                <div class="input-group md:col-span-2">
                    <label for="prompt-negatif-teks">Prompt Negatif (Opsional)</label>
                    <textarea id="prompt-negatif-teks" rows="2" placeholder="Apa yang tidak diinginkan dalam teks"></textarea>
                </div>
            </div>
        </div>

        <!-- Main Control Buttons -->
        <div class="flex flex-wrap justify-center gap-4 mb-8">
            <button id="btn-bersihkan" class="button-secondary">üñåÔ∏è Bersihkan</button>
            <button id="btn-acak" class="button-secondary">üí° Acak</button>
            <button id="btn-buat-manual" class="button-secondary">üöÄ Buat Manual</button>
            <button id="btn-buat-ai" class="button-primary">‚ú® Buat dengan AI</button>
        </div>

        <!-- Additional Feature Buttons (Gambar Tab Only) -->
        <div id="additional-features" class="flex flex-wrap justify-center gap-4 mb-8">
            <button id="btn-tingkatkan-prompt" class="button-secondary">‚ú® Tingkatkan Prompt</button>
            <button id="btn-sarankan-kata-kunci" class="button-secondary">‚ú® Sarankan Kata Kunci</button>
            <button id="btn-hasilkan-deskripsi" class="button-secondary">‚ú® Hasilkan Deskripsi</button>
            <button id="btn-buat-variasi-prompt" class="button-secondary">‚ú® Buat Variasi Prompt</button>
            <button id="btn-perbaiki-gramatika" class="button-secondary">‚ú® Perbaiki Gramatika/Ejaan</button>
            <button id="btn-sarankan-palet-warna" class="button-secondary">‚ú® Sarankan Palet Warna</button>
            <button id="btn-sarankan-konsep-terkait" class="button-secondary">‚ú® Sarankan Konsep Terkait</button>
        </div>

        <!-- Translation Dropdown -->
        <div class="flex justify-end mb-8">
            <div class="input-group w-48">
                <label for="terjemahan-bahasa">Terjemahkan Hasil ke</label>
                <select id="terjemahan-bahasa">
                    <option value="">Pilih</option>
                    <option value="en">Inggris</option>
                    <option value="id">Indonesia</option>
                    <option value="es">Spanyol</option>
                    <option value="fr">Prancis</option>
                    <option value="de">Jerman</option>
                    <option value="ja">Jepang</option>
                    <option value="ko">Korea</option>
                    <option value="zh">Mandarin</option>
                </select>
            </div>
        </div>

        <!-- Result Area for Main Prompt -->
        <div class="result-area p-6 rounded-lg shadow-inner">
            <h3 class="text-xl font-bold mb-4 text-gray-200">Hasil Prompt Utama:</h3>
            <div id="loading-indicator-main" class="loading-spinner hidden"></div>
            <div id="result-content" class="text-gray-300">
                <!-- Generated main prompt will appear here -->
            </div>
        </div>

        <!-- New Result Area for Additional Features -->
        <div id="additional-results-area" class="additional-results-area p-6 rounded-lg shadow-inner hidden">
            <h3 class="text-xl font-bold mb-4 text-gray-200">Hasil Fitur Tambahan:</h3>
            <div id="loading-indicator-additional" class="loading-spinner hidden"></div>
            <div id="additional-content" class="text-gray-300">
                <!-- Results from additional features will appear here -->
            </div>
        </div>
    </div>

    <!-- Message Box -->
    <div id="message-box" class="message-box hidden"></div>

    <script type="module">
        // API Key for Gemini (empty string will be filled by Canvas runtime)
        const apiKey = "";

        // DOM Elements
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');
        const additionalFeaturesDiv = document.getElementById('additional-features');
        const resultDiv = document.getElementById('result-content'); // Main prompt area
        const additionalResultsArea = document.getElementById('additional-results-area'); // New: Additional features result area
        const additionalContentDiv = document.getElementById('additional-content'); // Content inside additional results area
        const loadingIndicatorMain = document.getElementById('loading-indicator-main'); // Loading for main prompt
        const loadingIndicatorAdditional = document.getElementById('loading-indicator-additional'); // Loading for additional features
        const translationDropdown = document.getElementById('terjemahan-bahasa');
        const messageBox = document.getElementById('message-box'); // Message box element
        const userStatusMessage = document.getElementById('user-status-message'); // User status message element

        // Input fields for Gambar tab
        const gambarInputs = {
            gaya: document.getElementById('gaya-gambar'),
            kategori: document.getElementById('kategori-gambar'),
            sudutKamera: document.getElementById('sudut-kamera'),
            waktuPencahayaan: document.getElementById('waktu-pencahayaan'),
            subjek: document.getElementById('subjek-gambar'),
            aksi: document.getElementById('aksi-gambar'),
            pengaturan: document.getElementById('pengaturan-gambar'),
            suasanaEmosi: document.getElementById('suasana-emosi-gambar'),
            bahanTekstur: document.getElementById('bahan-tekstur-gambar'),
            ekspresiEmosi: document.getElementById('ekspresi-emosi-gambar'),
            usiaEra: document.getElementById('usia-era-gambar'),
            rasioAspek: document.getElementById('rasio-aspek-gambar'),
            resolusi: document.getElementById('resolusi-gambar'),
            komposisi: document.getElementById('komposisi-gambar'),
            paletWarna: document.getElementById('palet-warna-gambar'),
            detailFokus: document.getElementById('detail-fokus-gambar'),
            referensiArtis: document.getElementById('referensi-artis-gambar'),
            ideTambahan: document.getElementById('ide-tambahan-gambar'),
            promptNegatif: document.getElementById('prompt-negatif-gambar')
        };

        // Input fields for Video Tunggal tab
        const videoInputs = {
            subjek: document.getElementById('subjek-video'),
            karakterUtama: document.getElementById('karakter-utama-video'),
            karakterPendukung: document.getElementById('karakter-pendukung-video'),
            jumlahKarakter: document.getElementById('jumlah-karakter-video'),
            aksi: document.getElementById('aksi-video'),
            pengaturan: document.getElementById('pengaturan-video'),
            suasanaEmosi: document.getElementById('suasana-emosi-video'),
            durasi: document.getElementById('durasi-video'),
            pergerakanKamera: document.getElementById('pergerakan-kamera'),
            gayaVideo: document.getElementById('gaya-video'),
            bahasaDialog: document.getElementById('bahasa-dialog'),
            backsound: document.getElementById('backsound-video'),
            efekSuara: document.getElementById('efek-suara-video'),
            jenisShot: document.getElementById('jenis-shot-video'),
            transisi: document.getElementById('transisi-video'),
            kecepatanGerak: document.getElementById('kecepatan-gerak-video'),
            waktuDalamVideo: document.getElementById('waktu-dalam-video'),
            ideTambahan: document.getElementById('ide-tambahan-video'),
            promptNegatif: document.getElementById('prompt-negatif-video')
        };

        // Input fields for Sutradara tab
        const sutradaraInputs = {
            durasiVideoTotal: document.getElementById('durasi-video-total-sutradara'),
            durasiPerSegmen: document.getElementById('durasi-per-segmen-sutradara'),
            gayaVideoSutradara: document.getElementById('gaya-video-sutradara'),
            subjekUtamaSkenario: document.getElementById('subjek-utama-skenario'),
            alurCeritaSingkat: document.getElementById('alur-cerita-singkat'),
            genre: document.getElementById('genre-sutradara'),
            strukturNarasi: document.getElementById('struktur-narasi-sutradara'),
            tone: document.getElementById('tone-sutradara'),
            targetAudiens: document.getElementById('target-audiens-sutradara'),
            pesanTema: document.getElementById('pesan-tema-sutradara'),
            ideTambahanSkenario: document.getElementById('ide-tambahan-skenario'),
            promptNegatifSkenario: document.getElementById('prompt-negatif-skenario')
        };

        // Input fields for Teks tab
        const textInputs = {
            topikTeks: document.getElementById('topik-teks'),
            gayaTeks: document.getElementById('gaya-teks'),
            audiensTargetTeks: document.getElementById('audiens-target-teks'),
            tujuanTeks: document.getElementById('tujuan-teks'),
            panjangTeks: document.getElementById('panjang-teks'),
            strukturTeks: document.getElementById('struktur-teks'),
            nadaTeks: document.getElementById('nada-teks'),
            kataKunciUtamaTeks: document.getElementById('kata-kunci-utama-teks'),
            sumberReferensiTeks: document.getElementById('sumber-referensi-teks'),
            ideTambahanTeks: document.getElementById('ide-tambahan-teks'),
            promptNegatifTeks: document.getElementById('prompt-negatif-teks')
        };

        // Container for dynamic dialog fields (Video Tunggal tab)
        const dialogFieldsContainer = document.getElementById('dialog-fields-container');

        // Store the last generated English prompt for additional features and translation
        let lastEnglishPrompt = '';
        let lastIndonesianPrompt = '';

        // Function to show/hide loading spinner for specific area
        function showLoading(show, area = 'main') {
            if (show) {
                if (area === 'main') {
                    loadingIndicatorMain.classList.remove('hidden');
                    resultDiv.innerHTML = ''; // Clear previous results
                } else if (area === 'additional') {
                    loadingIndicatorAdditional.classList.remove('hidden');
                    additionalContentDiv.innerHTML = ''; // Clear previous additional results
                    additionalResultsArea.classList.remove('hidden'); // Ensure additional area is visible
                }
            } else {
                if (area === 'main') {
                    loadingIndicatorMain.classList.add('hidden');
                } else if (area === 'additional') {
                    loadingIndicatorAdditional.classList.add('hidden');
                }
            }
        }

        // Function to display messages (success/error)
        function showMessage(message, isError = false) {
            messageBox.textContent = message;
            messageBox.className = 'message-box show'; // Reset classes
            if (isError) {
                messageBox.classList.add('error');
            } else {
                messageBox.classList.remove('error');
            }
            setTimeout(() => {
                messageBox.classList.remove('show');
            }, 3000); // Hide after 3 seconds
        }

        // Function to call Gemini API
        async function callGeminiAPI(prompt, schema = null, targetArea = 'main') {
            showLoading(true, targetArea);
            let chatHistory = [];
            chatHistory.push({ role: "user", parts: [{ text: prompt }] });

            const payload = { contents: chatHistory };
            if (schema) {
                payload.generationConfig = {
                    responseMimeType: "application/json",
                    responseSchema: schema
                };
            }

            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const result = await response.json();

                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    if (schema) {
                        try {
                            return JSON.parse(text); // Return parsed JSON for structured responses
                        } catch (e) {
                            console.error("Error parsing JSON response:", e, "Raw text:", text);
                            showMessage("Error: Gagal memproses respons AI (JSON tidak valid).", true);
                            return "Error: Gagal memproses respons AI.";
                        }
                    }
                    return text; // Return plain text for unstructured responses
                } else {
                    console.error("Unexpected API response structure:", result);
                    showMessage("Error: Tidak dapat menghasilkan respons dari AI. Coba lagi.", true);
                    return "Error: Tidak dapat menghasilkan respons dari AI. Coba lagi.";
                }
            } catch (error) {
                console.error("Error calling Gemini API:", error);
                showMessage("Error: Terjadi kesalahan saat menghubungi AI. Periksa koneksi Anda atau coba lagi.", true);
                return "Error: Terjadi kesalahan saat menghubungi AI. Periksa koneksi Anda atau coba lagi.";
            } finally {
                showLoading(false, targetArea);
            }
        }

        // Function to dynamically generate dialog fields based on 'Jumlah Karakter'
        function generateDialogFields(numCharacters) {
            dialogFieldsContainer.innerHTML = ''; // Clear existing fields
            // Remove old dynamic dialog elements from videoInputs to prevent memory leaks/stale references
            for (const key in videoInputs) {
                if (key.startsWith('dialogKarakter')) {
                    delete videoInputs[key];
                }
            }

            if (numCharacters > 0) {
                for (let i = 1; i <= numCharacters; i++) {
                    const inputGroup = document.createElement('div');
                    inputGroup.className = 'input-group md:col-span-2'; // Each dialog field takes full width
                    inputGroup.innerHTML = `
                        <label for="dialog-karakter-${i}">Dialog Karakter ${i} (Opsional)</label>
                        <textarea id="dialog-karakter-${i}" rows="2" placeholder="Dialog untuk karakter ${i}"></textarea>
                    `;
                    dialogFieldsContainer.appendChild(inputGroup);
                    // Add the newly created textarea to the videoInputs object
                    videoInputs[`dialogKarakter${i}`] = document.getElementById(`dialog-karakter-${i}`);
                }
            }
        }

        // Event listener for 'Jumlah Karakter' input
        videoInputs.jumlahKarakter.addEventListener('input', (event) => {
            const num = parseInt(event.target.value);
            if (!isNaN(num) && num >= 0) {
                generateDialogFields(num);
            } else {
                generateDialogFields(0); // Clear fields if input is invalid
            }
        });


        // Function to switch tabs
        function switchTab(tabId) {
            tabButtons.forEach(button => {
                button.classList.remove('active');
            });
            tabContents.forEach(content => {
                content.classList.add('hidden');
            });

            document.getElementById(`tab-${tabId}`).classList.add('active');
            document.getElementById(`tab-content-${tabId}`).classList.remove('hidden');

            // Additional features are always visible now as login is removed
            additionalFeaturesDiv.classList.remove('hidden');

            // Clear all results and last prompts on tab switch
            resultDiv.innerHTML = '';
            additionalContentDiv.innerHTML = ''; // Clear additional results area
            additionalResultsArea.classList.add('hidden'); // Hide additional results area
            lastEnglishPrompt = '';
            lastIndonesianPrompt = '';

            // If switching to video tab, ensure dialog fields are generated based on current number
            if (tabId === 'video-tunggal') {
                const num = parseInt(videoInputs.jumlahKarakter.value);
                if (!isNaN(num) && num >= 0) {
                    generateDialogFields(num);
                }
            }
        }

        // Event listeners for tab buttons
        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                const tabId = button.id.replace('tab-', '');
                switchTab(tabId);
            });
        });

        // Initialize with Gambar tab active
        switchTab('gambar');

        // Function to clear all input fields for the active tab
        function clearInputs() {
            const activeTabContent = document.querySelector('.tab-content:not(.hidden)');
            if (activeTabContent) {
                activeTabContent.querySelectorAll('input, textarea, select').forEach(input => {
                    if (input.type === 'number') {
                        input.value = input.min || ''; // Reset number inputs to min or empty
                    } else if (input.tagName === 'SELECT') {
                        input.value = ''; // Reset select to default empty option
                    } else {
                        input.value = '';
                    }
                });
            }
            // Specifically clear dynamic dialog fields and reset count for video tab
            if (activeTabContent.id === 'tab-content-video-tunggal') {
                videoInputs.jumlahKarakter.value = '0';
                generateDialogFields(0); // Clear dynamic fields
            }
            resultDiv.innerHTML = ''; // Clear main result area
            additionalContentDiv.innerHTML = ''; // Clear additional results area
            additionalResultsArea.classList.add('hidden'); // Hide additional results area
            lastEnglishPrompt = '';
            lastIndonesianPrompt = '';
        }

        // Function to populate inputs with random/generic values (simple placeholder)
        function randomizeInputs() {
            const activeTabContent = document.querySelector('.tab-content:not(.hidden)');
            if (activeTabContent.id === 'tab-content-gambar') {
                gambarInputs.gaya.value = 'Seni Digital';
                gambarInputs.kategori.value = 'Alam/Lanskap';
                gambarInputs.sudutKamera.value = 'Close-up';
                gambarInputs.waktuPencahayaan.value = 'Golden Hour';
                gambarInputs.subjek.value = 'Pohon besar dengan akar yang menjalar';
                gambarInputs.aksi.value = 'Berdiri tegak di tengah padang rumput';
                gambarInputs.pengaturan.value = 'Latar belakang pegunungan berkabut';
                gambarInputs.suasanaEmosi.value = 'Tenang';
                gambarInputs.bahanTekstur.value = 'Kayu';
                gambarInputs.ekspresiEmosi.value = 'Senyum lebar';
                gambarInputs.usiaEra.value = 'Masa depan';
                gambarInputs.rasioAspek.value = '16:9';
                gambarInputs.resolusi.value = '4K';
                gambarInputs.komposisi.value = 'Aturan Sepertiga';
                gambarInputs.paletWarna.value = 'Hangat';
                gambarInputs.detailFokus.value = 'Sangat Detail';
                gambarInputs.referensiArtis.value = 'Gaya Van Gogh';
                gambarInputs.ideTambahan.value = 'Detail tambahan atau instruksi khusus';
                gambarInputs.promptNegatif.value = 'Buruk, Distorsi';
            } else if (activeTabContent.id === 'tab-content-video-tunggal') {
                videoInputs.subjek.value = 'Gelombang laut';
                videoInputs.karakterUtama.value = 'Seekor burung camar';
                videoInputs.karakterPendukung.value = 'Beberapa kepiting kecil';
                videoInputs.jumlahKarakter.value = '2'; // Set to 2 characters for random
                generateDialogFields(2); // Generate 2 dialog fields
                // Assign example dialogues to the dynamically created fields
                if (videoInputs.dialogKarakter1) videoInputs.dialogKarakter1.value = 'Karakter 1: Halo, apa kabar?';
                if (videoInputs.dialogKarakter2) videoInputs.dialogKarakter2.value = 'Karakter 2: Baik, terima kasih!';
                videoInputs.aksi.value = 'Berdebur ke pantai';
                videoInputs.pengaturan.value = 'Pemandangan pantai yang indah';
                videoInputs.suasanaEmosi.value = 'Damai';
                videoInputs.durasi.value = '10';
                videoInputs.pergerakanKamera.value = 'Pan';
                videoInputs.gayaVideo.value = 'Cinematic'; // Set dropdown value
                videoInputs.bahasaDialog.value = 'Bahasa Indonesia';
                videoInputs.backsound.value = 'Musik latar ombak laut'; // Example backsound
                videoInputs.efekSuara.value = 'Suara burung camar, Deburan ombak'; // Example sound effects
                videoInputs.jenisShot.value = 'Establishing Shot';
                videoInputs.transisi.value = 'Cut';
                videoInputs.kecepatanGerak.value = 'Normal';
                videoInputs.waktuDalamVideo.value = 'Awal adegan';
                videoInputs.ideTambahan.value = 'Detail tambahan atau instruksi khusus untuk video';
                videoInputs.promptNegatif.value = 'Goyangan kamera, Orang-orang';
            } else if (activeTabContent.id === 'tab-content-sutradara') {
                sutradaraInputs.durasiVideoTotal.value = '20'; // Example: 20 seconds total
                sutradaraInputs.durasiPerSegmen.value = '8'; // Example: 8 seconds per segment
                sutradaraInputs.gayaVideoSutradara.value = 'Documentary';
                sutradaraInputs.subjekUtamaSkenario.value = 'Perjalanan penemuan di hutan belantara Amazon';
                sutradaraInputs.alurCeritaSingkat.value = 'Seorang penjelajah memulai perjalanan untuk menemukan spesies tumbuhan langka. Dia menghadapi tantangan alam dan bertemu suku asli, belajar tentang kebijaksanaan kuno.';
                sutradaraInputs.genre.value = 'Documentary';
                sutradaraInputs.strukturNarasi.value = 'Linear';
                sutradaraInputs.tone.value = 'Inspiratif';
                sutradaraInputs.targetAudiens.value = 'Umum';
                sutradaraInputs.pesanTema.value = 'Pentingnya persahabatan';
                sutradaraInputs.ideTambahanSkenario.value = 'Gunakan drone footage untuk pemandangan luas. Fokus pada detail flora dan fauna.';
                sutradaraInputs.promptNegatifSkenario.value = 'Kekerasan, Konflik, Perusakan lingkungan';
            } else if (activeTabContent.id === 'tab-content-teks') {
                textInputs.topikTeks.value = 'Manfaat AI dalam kehidupan sehari-hari';
                textInputs.gayaTeks.value = 'Informatif';
                textInputs.audiensTargetTeks.value = 'Masyarakat umum';
                textInputs.tujuanTeks.value = 'Memberikan pemahaman dasar';
                textInputs.panjangTeks.value = 'Sedang (3-5 paragraf)';
                textInputs.strukturTeks.value = 'Posting Blog';
                textInputs.nadaTeks.value = 'Tenang';
                textInputs.kataKunciUtamaTeks.value = 'AI, teknologi, manfaat, kehidupan sehari-hari';
                textInputs.sumberReferensiTeks.value = 'Berdasarkan penelitian terbaru';
                textInputs.ideTambahanTeks.value = 'Sertakan contoh konkret dan mudah dipahami.';
                textInputs.promptNegatifTeks.value = 'Jargon teknis yang rumit, nada yang terlalu formal';
            }
            resultDiv.innerHTML = ''; // Clear main result area
            additionalContentDiv.innerHTML = ''; // Clear additional results area
            additionalResultsArea.classList.add('hidden'); // Hide additional results area
            lastEnglishPrompt = '';
            lastIndonesianPrompt = '';
        }

        // Event listener for Bersihkan button
        document.getElementById('btn-bersihkan').addEventListener('click', clearInputs);

        // Event listener for Acak button
        document.getElementById('btn-acak').addEventListener('click', randomizeInputs);

        // Event listener for Buat Manual button
        document.getElementById('btn-buat-manual').addEventListener('click', () => {
            // For "Buat Manual", we just concatenate the current input values
            const activeTabContent = document.querySelector('.tab-content:not(.hidden)');
            let manualPrompt = '';

            if (activeTabContent.id === 'tab-content-gambar') {
                manualPrompt = Object.keys(gambarInputs).map(key => {
                    const value = gambarInputs[key].value.trim();
                    const label = gambarInputs[key].previousElementSibling.textContent.replace('(Opsional)', '').trim();
                    return value ? `${label}: ${value}` : '';
                }).filter(Boolean).join('\n');
            } else if (activeTabContent.id === 'tab-content-video-tunggal') {
                const params = [];
                for (const key of ['subjek', 'karakterUtama', 'karakterPendukung', 'aksi', 'pengaturan', 'suasanaEmosi', 'durasi', 'pergerakanKamera', 'gayaVideo', 'bahasaDialog', 'backsound', 'efekSuara', 'jenisShot', 'transisi', 'kecepatanGerak', 'waktuDalamVideo', 'ideTambahan', 'promptNegatif']) {
                    const inputElement = videoInputs[key];
                    if (inputElement && inputElement.value.trim()) {
                        let label = inputElement.previousElementSibling.textContent.replace('(Opsional)', '').trim();
                        params.push(`${label}: ${inputElement.value.trim()}`);
                    }
                }
                const numCharacters = parseInt(videoInputs.jumlahKarakter.value);
                if (!isNaN(numCharacters) && numCharacters > 0) {
                    let dialogs = [];
                    for (let i = 1; i <= numCharacters; i++) {
                        const dialogInput = videoInputs[`dialogKarakter${i}`];
                        if (dialogInput && dialogInput.value.trim()) {
                            dialogs.push(`Karakter ${i}: "${dialogInput.value.trim()}"`);
                        }
                    }
                    if (dialogs.length > 0) {
                        params.push(`Dialog: ${dialogs.join(' | ')}`);
                    }
                }
                manualPrompt = params.filter(Boolean).join('\n');
            } else if (activeTabContent.id === 'tab-content-sutradara') {
                manualPrompt = Object.keys(sutradaraInputs).map(key => {
                    const value = sutradaraInputs[key].value.trim();
                    const label = sutradaraInputs[key].previousElementSibling.textContent.replace('(Opsional)', '').trim();
                    return value ? `${label}: ${value}` : '';
                }).filter(Boolean).join('\n');
                manualPrompt = `Skenario Video Manual:\n${manualPrompt}`;
            } else if (activeTabContent.id === 'tab-content-teks') {
                manualPrompt = Object.keys(textInputs).map(key => {
                    const value = textInputs[key].value.trim();
                    const label = textInputs[key].previousElementSibling.textContent.replace('(Opsional)', '').trim();
                    return value ? `${label}: ${value}` : '';
                }).filter(Boolean).join('\n');
                manualPrompt = `Teks Manual:\n${manualPrompt}`;
            } else {
                manualPrompt = "Tidak ada input yang terdeteksi untuk tab ini.";
            }

            resultDiv.innerHTML = `
                <h4 class="text-lg font-semibold text-gray-100 mb-2">Prompt Manual:</h4>
                <textarea id="manual-prompt-output" class="w-full p-3 rounded-lg border border-gray-600 bg-gray-700 text-gray-200" rows="10" readonly>${manualPrompt}</textarea>
            `;
            additionalContentDiv.innerHTML = ''; // Clear additional results area
            additionalResultsArea.classList.add('hidden'); // Hide additional results area
            lastEnglishPrompt = manualPrompt; // Store manual prompt for potential translation
            lastIndonesianPrompt = manualPrompt; // Assuming manual input is in Indonesian
        });


        // Event listener for Buat dengan AI button
        document.getElementById('btn-buat-ai').addEventListener('click', async () => {
            const activeTabContent = document.querySelector('.tab-content:not(.hidden)');
            let promptText = '';
            let schema = null; // Default schema for single prompt output

            // Clear additional results area when generating main prompt
            additionalContentDiv.innerHTML = '';
            additionalResultsArea.classList.add('hidden');

            if (activeTabContent.id === 'tab-content-gambar') {
                schema = {
                    type: "OBJECT",
                    properties: {
                        english_prompt: { type: "STRING" },
                        indonesian_prompt: { type: "STRING" }
                    },
                    required: ["english_prompt", "indonesian_prompt"]
                };

                const params = Object.keys(gambarInputs).map(key => {
                    const value = gambarInputs[key].value.trim();
                    const label = gambarInputs[key].previousElementSibling.textContent.replace('(Opsional)', '').trim();
                    return value ? `${label}: ${value}` : '';
                }).filter(Boolean).join('\n');

                if (!params.trim()) {
                    showMessage("Harap isi setidaknya satu bidang untuk menghasilkan prompt gambar.", true);
                    return;
                }

                promptText = `Buat prompt gambar detail dalam bahasa Inggris dan terjemahannya dalam bahasa Indonesia berdasarkan parameter berikut:\n${params}\nFormat output JSON dengan kunci 'english_prompt' dan 'indonesian_prompt'.`;

            } else if (activeTabContent.id === 'tab-content-video-tunggal') {
                schema = {
                    type: "OBJECT",
                    properties: {
                        english_prompt: { type: "STRING" },
                        indonesian_prompt: { type: "STRING" }
                    },
                    required: ["english_prompt", "indonesian_prompt"]
                };

                const params = [];
                // Collect static video inputs
                for (const key of ['subjek', 'karakterUtama', 'karakterPendukung', 'aksi', 'pengaturan', 'suasanaEmosi', 'durasi', 'pergerakanKamera', 'gayaVideo', 'bahasaDialog', 'backsound', 'efekSuara', 'jenisShot', 'transisi', 'kecepatanGerak', 'waktuDalamVideo', 'ideTambahan', 'promptNegatif']) {
                    const inputElement = videoInputs[key];
                    if (inputElement && inputElement.value.trim()) {
                        let label = inputElement.previousElementSibling.textContent.replace('(Opsional)', '').trim();
                        params.push(`${label}: ${inputElement.value.trim()}`);
                    }
                }
                const numCharacters = parseInt(videoInputs.jumlahKarakter.value);
                if (!isNaN(numCharacters) && numCharacters > 0) {
                    let dialogs = [];
                    for (let i = 1; i <= numCharacters; i++) {
                        const dialogInput = videoInputs[`dialogKarakter${i}`];
                        if (dialogInput && dialogInput.value.trim()) {
                            dialogs.push(`Karakter ${i}: "${dialogInput.value.trim()}"`);
                        }
                    }
                    if (dialogs.length > 0) {
                        params.push(`Dialog: ${dialogs.join(' | ')}`); // Join dialogues with a clear separator
                    }
                }

                if (!params.filter(Boolean).join('\n').trim()) {
                    showMessage("Harap isi setidaknya satu bidang untuk menghasilkan prompt video.", true);
                    return;
                }

                promptText = `Buat prompt video detail dalam bahasa Inggris dan terjemahannya dalam bahasa Indonesia berdasarkan parameter berikut:\n${params.filter(Boolean).join('\n')}\nPastikan dialog setiap karakter jelas terpisah. Format output JSON dengan kunci 'english_prompt' dan 'indonesian_prompt'.`;
            } else if (activeTabContent.id === 'tab-content-sutradara') {
                const totalDuration = parseInt(sutradaraInputs.durasiVideoTotal.value);
                const segmentDuration = parseInt(sutradaraInputs.durasiPerSegmen.value);

                if (isNaN(totalDuration) || totalDuration <= 0 || isNaN(segmentDuration) || segmentDuration <= 0) {
                    showMessage('Error: Durasi Video Total dan Durasi Per Segmen harus angka positif.', true);
                    return;
                }

                const numSegments = Math.ceil(totalDuration / segmentDuration);

                schema = {
                    type: "OBJECT",
                    properties: {
                        segments: {
                            type: "ARRAY",
                            items: {
                                type: "OBJECT",
                                properties: {
                                    segment_number: { type: "NUMBER" },
                                    english_prompt: { type: "STRING" },
                                    indonesian_prompt: { type: "STRING" }
                                },
                                required: ["segment_number", "english_prompt", "indonesian_prompt"]
                            }
                        }
                    },
                    required: ["segments"]
                };

                const params = Object.keys(sutradaraInputs).map(key => {
                    const value = sutradaraInputs[key].value.trim();
                    const label = sutradaraInputs[key].previousElementSibling.textContent.replace('(Opsional)', '').trim();
                    return value ? `${label}: ${value}` : '';
                }).filter(Boolean).join('\n');

                if (!params.trim()) {
                    showMessage("Harap isi setidaknya satu bidang untuk menghasilkan skenario sutradara.", true);
                    return;
                }

                promptText = `Buat skenario video yang terbagi menjadi ${numSegments} segmen, dengan setiap segmen berdurasi sekitar ${segmentDuration} detik, berdasarkan total durasi ${totalDuration} detik.
                Parameter umum untuk skenario:
                ${params}
                Untuk setiap segmen, berikan prompt gambar/video detail dalam bahasa Inggris dan terjemahannya dalam bahasa Indonesia.
                **Sangat penting:** Pastikan kontinuitas karakter, tema, suasana, dan alur cerita terjaga dengan mulus dari satu segmen ke segmen berikutnya. Karakter harus konsisten dalam penampilan dan perilaku. Tema dan suasana harus berkembang secara logis.
                Format output JSON dengan kunci 'segments' yang berisi array objek, setiap objek memiliki 'segment_number', 'english_prompt', dan 'indonesian_prompt'.`;
            } else if (activeTabContent.id === 'tab-content-teks') {
                schema = {
                    type: "OBJECT",
                    properties: {
                        english_text: { type: "STRING" },
                        indonesian_text: { type: "STRING" }
                    },
                    required: ["english_text", "indonesian_text"]
                };

                const params = Object.keys(textInputs).map(key => {
                    const value = textInputs[key].value.trim();
                    const label = textInputs[key].previousElementSibling.textContent.replace('(Opsional)', '').trim();
                    return value ? `${label}: ${value}` : '';
                }).filter(Boolean).join('\n');

                if (!params.trim()) {
                    showMessage("Harap isi setidaknya satu bidang untuk menghasilkan teks.", true);
                    return;
                }

                promptText = `Buat teks detail dalam bahasa Inggris dan terjemahannya dalam bahasa Indonesia berdasarkan parameter berikut:\n${params}\nFormat output JSON dengan kunci 'english_text' dan 'indonesian_text'.`;
            }
            else {
                showMessage('Fungsionalitas AI belum tersedia untuk tab ini.', true);
                return;
            }

            const response = await callGeminiAPI(promptText, schema, 'main'); // Specify 'main' area for loading

            if (activeTabContent.id === 'tab-content-sutradara') {
                if (typeof response === 'object' && response.segments && Array.isArray(response.segments)) {
                    let outputHtml = '<h4 class="text-xl font-bold mb-4 text-gray-200">Skenario Video per Segmen:</h4>';
                    response.segments.forEach(segment => {
                        outputHtml += `<div class="mb-6 p-4 rounded-lg bg-gray-800 border border-gray-700">
                                            <h5 class="text-md font-semibold text-gray-200 mb-2">Segmen ${segment.segment_number}:</h5>
                                            <p class="mb-2"><strong>English:</strong> ${segment.english_prompt}</p>
                                            <p><strong>Indonesia:</strong> ${segment.indonesian_prompt}</p>
                                        </div>`;
                    });
                    resultDiv.innerHTML = outputHtml;
                    // For Sutradara, we don't store lastEnglishPrompt in the same way as it's multiple prompts
                    lastEnglishPrompt = '';
                    lastIndonesianPrompt = '';
                } else {
                    resultDiv.innerHTML = `<p class="text-red-400">Error: Struktur respons skenario tidak sesuai.</p><p>${JSON.stringify(response)}</p>`;
                    showMessage("Error: Struktur respons skenario tidak sesuai.", true);
                }
            } else if (activeTabContent.id === 'tab-content-teks') {
                if (typeof response === 'object' && response.english_text && response.indonesian_text) {
                    lastEnglishPrompt = response.english_text; // Store generated text as last English prompt for translation
                    lastIndonesianPrompt = response.indonesian_text;
                    resultDiv.innerHTML = `
                        <h4 class="text-lg font-semibold text-gray-100 mb-2">Teks Bahasa Inggris:</h4>
                        <p class="mb-4">${lastEnglishPrompt}</p>
                        <h4 class="text-lg font-semibold text-gray-100 mb-2">Teks Bahasa Indonesia:</h4>
                        <p>${lastIndonesianPrompt}</p>
                    `;
                } else {
                    resultDiv.innerHTML = `<p class="text-red-400">${response}</p>`;
                    showMessage("Error: Gagal menghasilkan teks.", true);
                }
            }
            else { // For Gambar and Video Tunggal
                if (typeof response === 'object' && response.english_prompt && response.indonesian_prompt) {
                    lastEnglishPrompt = response.english_prompt;
                    lastIndonesianPrompt = response.indonesian_prompt;
                    resultDiv.innerHTML = `
                        <h4 class="text-lg font-semibold text-gray-100 mb-2">Prompt Bahasa Inggris:</h4>
                        <p class="mb-4">${lastEnglishPrompt}</p>
                        <h4 class="text-lg font-semibold text-gray-100 mb-2">Prompt Bahasa Indonesia:</h4>
                        <p>${lastIndonesianPrompt}</p>
                    `;
                } else {
                    resultDiv.innerHTML = `<p class="text-red-400">${response}</p>`;
                    showMessage("Error: Gagal menghasilkan prompt.", true);
                }
            }
        });

        // Function to handle additional feature buttons
        async function handleAdditionalFeature(feature) {
            // Check if a main prompt has been generated
            if (!lastEnglishPrompt) {
                additionalContentDiv.innerHTML = '<p class="text-yellow-400">Silakan buat prompt utama terlebih dahulu menggunakan "Buat dengan AI".</p>';
                additionalResultsArea.classList.remove('hidden');
                return;
            }

            // Clear previous additional results and show the area
            additionalContentDiv.innerHTML = '';
            additionalResultsArea.classList.remove('hidden');

            let promptToProcess = lastEnglishPrompt; // Default to English prompt for processing
            let instruction = '';
            let schema = null; // Default schema for single string output

            // Determine the instruction and schema based on the feature
            switch (feature) {
                case 'tingkatkan-prompt':
                    instruction = `Tingkatkan prompt gambar/video berikut menjadi lebih detail dan kreatif:`;
                    break;
                case 'sarankan-kata-kunci':
                    instruction = `Saran kata kunci terkait untuk prompt gambar/video berikut (dalam format daftar poin):`;
                    schema = {
                        type: "ARRAY",
                        items: { type: "STRING" }
                    };
                    break;
                case 'hasilkan-deskripsi':
                    instruction = `Hasilkan deskripsi singkat (sekitar 2-3 kalimat) berdasarkan prompt gambar/video berikut:`;
                    break;
                case 'buat-variasi-prompt':
                    instruction = `Buat 3 variasi prompt gambar/video berikut, masing-masing dalam satu baris terpisah:`;
                    schema = {
                        type: "ARRAY",
                        items: { type: "STRING" }
                    };
                    break;
                case 'perbaiki-gramatika':
                    instruction = `Perbaiki gramatika dan ejaan prompt gambar/video berikut:`;
                    break;
                case 'sarankan-palet-warna':
                    // For color palette, use relevant inputs from the active tab if available
                    const activeTabContent = document.querySelector('.tab-content:not(.hidden)');
                    if (activeTabContent.id === 'tab-content-gambar') {
                        promptToProcess = `Untuk gambar dengan subjek: "${gambarInputs.subjek.value.trim()}" dan pengaturan: "${gambarInputs.pengaturan.value.trim()}", sarankan palet warna yang cocok (dalam format daftar poin, sebutkan nama warna dan hex code jika memungkinkan):`;
                        if (!gambarInputs.subjek.value.trim() && !gambarInputs.pengaturan.value.trim()) {
                            additionalContentDiv.innerHTML = '<p class="text-yellow-400">Silakan isi Subjek dan Pengaturan di tab Gambar untuk saran palet warna.</p>';
                            return;
                        }
                    } else {
                        promptToProcess = `Untuk prompt berikut, sarankan palet warna yang cocok (dalam format daftar poin, sebutkan nama warna dan hex code jika memungkinkan): ${lastEnglishPrompt}`;
                    }
                    schema = {
                        type: "ARRAY",
                        items: { type: "STRING" }
                    };
                    break;
                case 'sarankan-konsep-terkait':
                    instruction = `Sarankan 3 konsep terkait atau ide-ide baru berdasarkan prompt gambar/video berikut (dalam format daftar poin):`;
                    schema = {
                        type: "ARRAY",
                        items: { type: "STRING" }
                    };
                    break;
                default:
                    additionalContentDiv.innerHTML = '<p class="text-red-400">Fitur tidak dikenal.</p>';
                    return;
            }

            const fullPrompt = `${instruction}\n\n${promptToProcess}`;
            const response = await callGeminiAPI(fullPrompt, schema, 'additional'); // Call API, targeting 'additional' area for loading

            // Display the response based on its type
            let outputHtml = `<h4 class="text-lg font-semibold text-gray-100 mb-2">Hasil ${feature.replace(/-/g, ' ').toUpperCase()}:</h4>`;
            if (Array.isArray(response)) {
                outputHtml += '<ul class="list-disc list-inside">';
                response.forEach(item => {
                    outputHtml += `<li>${item}</li>`;
                });
                outputHtml += '</ul>';
            } else {
                outputHtml += `<p>${response}</p>`;
            }
            additionalContentDiv.innerHTML = outputHtml;
        }

        // Event listener for additional feature buttons
        document.getElementById('btn-tingkatkan-prompt').addEventListener('click', () => handleAdditionalFeature('tingkatkan-prompt'));
        document.getElementById('btn-sarankan-kata-kunci').addEventListener('click', () => handleAdditionalFeature('sarankan-kata-kunci'));
        document.getElementById('btn-hasilkan-deskripsi').addEventListener('click', () => handleAdditionalFeature('hasilkan-deskripsi'));
        document.getElementById('btn-buat-variasi-prompt').addEventListener('click', () => handleAdditionalFeature('buat-variasi-prompt'));
        document.getElementById('btn-perbaiki-gramatika').addEventListener('click', () => handleAdditionalFeature('perbaiki-gramatika'));
        document.getElementById('btn-sarankan-palet-warna').addEventListener('click', () => handleAdditionalFeature('sarankan-palet-warna'));
        document.getElementById('btn-sarankan-konsep-terkait').addEventListener('click', () => handleAdditionalFeature('sarankan-konsep-terkait'));

        // Event listener for Translation Dropdown
        translationDropdown.addEventListener('change', async (event) => {
            const targetLanguageCode = event.target.value;
            let targetLanguageName = event.target.options[event.target.selectedIndex].text;

            if (!lastEnglishPrompt) {
                additionalContentDiv.innerHTML = '<p class="text-yellow-400">Silakan buat prompt utama terlebih dahulu menggunakan "Buat dengan AI".</p>';
                additionalResultsArea.classList.remove('hidden');
                return;
            }

            // Clear additional results area when performing translation
            additionalContentDiv.innerHTML = '';
            additionalResultsArea.classList.add('hidden');

            let textToTranslate = lastEnglishPrompt; // Default to English prompt for translation

            // If the current result displays an Indonesian prompt, and the user wants to translate from there
            // This logic can be expanded if users wants to translate other generated content
            if (resultDiv.innerHTML.includes(lastIndonesianPrompt) && targetLanguageCode !== 'id') {
                textToTranslate = lastIndonesianPrompt;
            }

            const promptText = `Terjemahkan teks berikut ini ke dalam bahasa ${targetLanguageName}.
            Teks: ${textToTranslate}`;

            const translatedText = await callGeminiAPI(promptText, null, 'additional'); // Specify 'additional' area for loading

            additionalContentDiv.innerHTML = `
                <h4 class="text-lg font-semibold text-gray-100 mb-2">Terjemahan (${targetLanguageName}):</h4>
                <p>${translatedText}</p>
            `;
        });
    </script>
</body>
</html>
